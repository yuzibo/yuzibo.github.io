<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>python爬虫之beautifulsoup用法</title>
    <meta name="description" content="快速开始软件安装sudo pip install beautifulsouppython的软件安装请参参考详细教程请参考这里:提醒大家，使用这个库，一定做好字符编码这个坑的准备https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.htmlfr...">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://0.0.0.0:4000/2017/06/20/python_beautifulsoup/">
    <link rel="alternate" type="application/rss+xml" title="vimer" href="http://0.0.0.0:4000/feed.xml ">





</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">vimer</a>
        <small>linux kernel 爱好者</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left">
        <h1>python爬虫之beautifulsoup用法</h1>
        <div class="label">

            <div class="label-card">
                <i class="fa fa-calendar"></i>2017-06-20
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
                
            </div>

            <div class="label-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#python" title="Category: python" rel="category">python</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

            <div class="label-card">
            
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <h1 id="快速开始">快速开始</h1>

<h2 id="软件安装">软件安装</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo pip install beautifulsoup
</code></pre></div></div>

<p>python的软件安装请参<a href="http://www.aftermath.cn/python_install_packets.html">参考</a></p>

<p>详细教程请参考这里:</p>

<p>提醒大家，使用这个库，一定做好字符编码这个坑的准备</p>

<p>https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">html_doc</span> <span class="o">=</span> <span class="s">"""
&lt;html&gt;&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;p class="title" name="dromouse"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
&lt;p class="story"&gt;Once upon a time there were three little sisters; and their names were
&lt;a href="http://example.com/elsie" class="sister" id="link1"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
&lt;a href="http://example.com/lacie" class="sister" id="link2"&gt;Lacie&lt;/a&gt; and
&lt;a href="http://example.com/tillie" class="sister" id="link3"&gt;Tillie&lt;/a&gt;;
and they lived at the bottom of a well.&lt;/p&gt;
&lt;p class="story"&gt;...&lt;/p&gt;
"""</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
</code></pre></div></div>
<p>当然，所有的用法是以上面的代码为基础的.
效果如下:</p>

<p><img src="http://yuzibo.qiniudn.com/bs_1.png" alt="png" /></p>

<h1 id="几个简单的用法">几个简单的用法</h1>

<p>下面代码中的注释就是输出内容.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span>
<span class="c1">#&lt;title&gt;The Dormouse's story&lt;/title&gt;
</span>
<span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="c1">#&lt;class 'bs4.element.Tag'&gt;
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">name</span>
<span class="c1">#title
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">string</span>
<span class="c1">#The Dormouse's story
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span>
<span class="c1">#head
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">p</span>
<span class="c1"># &lt;p class="title" name="dromouse"&gt;&lt;b&gt;The Dormouse's story&lt;/b&gt;&lt;/p&gt;
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">p</span><span class="p">[</span><span class="s">'class'</span><span class="p">]</span>
<span class="c1">#['title']
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">a</span>
<span class="c1">#&lt;a class="sister" href="http://example.com/elsie"
#id="link1"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="c1">#[class="sister" href="http://example.com/elsie" id="link1"&gt;&lt;!-- Elsie --&gt;&lt;/a&gt;,
#&lt;a class="sister" href="http://example.com/lacie" id="link2"&gt;Lacie&lt;/a&gt;,
#&lt;a class="sister" href="http://example.com/tillie" id="link3"&gt;Tillie&lt;/a&gt;]
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s">"link3"</span><span class="p">)</span>
<span class="c1">#&lt;a class="sister" href="http://example.com/tillie" id="link3"&gt;Tillie&lt;/a&gt;
</span></code></pre></div></div>

<p>实际上，那个主页上面的例子有些差错，我已经发邮件说了。</p>

<p>大家可以先看看这个例子，慢慢地我会逐一讲解。</p>

<p>这里可以使用loop将链接提取出来:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">))</span>
<span class="c1">#http://example.com/elsie
#http://example.com/lacie
#http://example.com/tillie
</span>
</code></pre></div></div>

<h1 id="对象类型">对象类型</h1>

<h3 id="tag">Tag</h3>
<p>在上面的代码中已经出现了这个，请看&lt;class ‘bs4.element.Tag’&gt;
这个类型有很多的属性，这里，重点记住它的属性和名称.</p>
<h4 id="name">name</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;b class="boldest"&gt;Extremely bold&lt;/b&gt;'</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
<span class="n">tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">b</span>
<span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
<span class="k">print</span> <span class="n">tag</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># 在这里你可以更改tag的名字，这样还可以将修改反应到原生的html
</span>
<span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'yubo'</span>
<span class="k">print</span> <span class="n">tag</span>
<span class="c1">#### 输出的内容:
</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">bs4</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Tag</span><span class="s">'&gt;</span><span class="err">
</span><span class="s">b</span><span class="err">
</span><span class="s">&lt;yubo class="boldest"&gt;Extremely bold&lt;/yubo&gt;</span><span class="err">
</span></code></pre></div></div>

<h4 id="attris">attris</h4>
<p>对于上面的代码来说就是这样，这里的属性就是class,也就是标签的属性。</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="n">tag</span><span class="p">[</span><span class="s">'class'</span><span class="p">]</span>

<span class="c1"># 你可以直接访问,注意这是一个字典:
</span>
<span class="k">print</span> <span class="n">tag</span><span class="o">.</span><span class="n">attrs</span>
<span class="p">{</span><span class="s">'class'</span><span class="p">:</span> <span class="p">[</span><span class="s">'boldest'</span><span class="p">]}</span>
</code></pre></div></div>

<p>这里有一个多值属性，就先不解释了</p>

<h4 id="navigablestring">NavigableString</h4>
<p>这个对象的含义就是一个tag对象所存储的文本内容,BeautifulSoup使用NavigableString这个类去存储文本。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="n">tag</span><span class="o">.</span><span class="n">string</span>
<span class="c1">#Extremely bold
</span>
<span class="k">print</span> <span class="nb">type</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="c1">#&lt;class 'bs4.element.NavigableString'&gt;
</span></code></pre></div></div>
<p>这里就涉及到令人烦恼的编码问题了。一个NavigableString对象就像Python Unicode字符串，你可以使用<em>unicode()</em>方法。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">unicode_string</span> <span class="o">=</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
<span class="k">print</span> <span class="n">unicode_string</span>
<span class="c1">#Extremely bold
</span>
<span class="n">tag</span><span class="o">.</span><span class="n">string</span><span class="o">.</span><span class="n">replace_with</span><span class="p">(</span><span class="s">"hello, yubo"</span><span class="p">)</span>
<span class="k">print</span> <span class="n">tag</span>
<span class="c1">#&lt;b class="boldest"&gt;hello, yubo&lt;/b&gt;
</span></code></pre></div></div>
<p>这里直接引用文档中的原文:
If you want to use a NavigableString outside of Beautiful Soup, you should call unicode() on it to turn it into a normal Python Unicode string. If you don’t, your string will carry around a reference to the entire Beautiful Soup parse tree, even when you’re done using Beautiful Soup. This is a big waste of memory.</p>

<h4 id="beautifulsoup">BeautifulSoup</h4>
<p>因为之前有Tag的对象，这个对象就是整个页面的集合组成，基本上用的不多.</p>

<h4 id="评论及其他">评论及其他</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">markup</span> <span class="o">=</span> <span class="s">"&lt;b&gt;&lt;!--Hey, buddy. Want to buy a used parser?--&gt;&lt;/b&gt;"</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">markup</span><span class="p">)</span>
<span class="n">comment</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">string</span>
<span class="nb">type</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
<span class="c1"># &lt;class 'bs4.element.Comment'&gt;
</span></code></pre></div></div>

<p>还是以上面的例子，html_doc的内容不变， 测试以下实验例句.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">a</span>
<span class="c1"># 这个语句打印匹配出第一个合适的&lt;a&gt;标签
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="c1">#这个语句就是打印出所有的&lt;a&gt;标签，这明显就是一个列表。
</span></code></pre></div></div>

<h5 id="contents-和-children">.contents 和 .children</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">head_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">head</span>
<span class="k">print</span> <span class="n">head_tag</span>
<span class="c1">#&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
</span>
<span class="k">print</span> <span class="n">head_tag</span><span class="o">.</span><span class="n">contents</span>
<span class="c1"># [&lt;title&gt;The Dormouse's story&lt;/title&gt;]
# actually, you can see that soup.head is tag,
# which contents is its sub-class and it is a list
</span>

<span class="k">print</span> <span class="n">head_tag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#&lt;title&gt;The Dormouse's story&lt;/title&gt;
# discard list
</span>
<span class="k">print</span> <span class="n">head_tag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">contents</span>
<span class="c1"># recursion... [u"The Dormouse's story"]
</span></code></pre></div></div>

<p>The “BeautifulSoup” object itself has children, in this case, the &lt;html&gt; is the child of the “BeautifulSoup”.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">head</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>
<span class="c1"># 1
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># html
# You need to think the same useage like about
</span>
<span class="n">title_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span>
<span class="k">print</span> <span class="n">title_tag</span>
<span class="c1"># &lt;title&gt;The Dormouse's story&lt;/title&gt;
</span>
<span class="k">print</span> <span class="n">title_tag</span><span class="o">.</span><span class="n">contents</span>
<span class="c1">#[u"The Dormouse's story"]
</span>
<span class="k">print</span> <span class="n">title_tag</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#The Dormouse's story
</span></code></pre></div></div>

<h5 id="descendants">.descendants</h5>

<p>The <em>.contents</em> and <em>.children</em> attribute only consider a tag’s direct chilren. For instance, the &lt;head&gt; tag has a single direct child-the <title> tag:</title></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">head_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">head</span>
<span class="k">print</span> <span class="n">head_tag</span>
<span class="c1"># &lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
</span>
<span class="k">print</span> <span class="n">head_tag</span><span class="o">.</span><span class="n">contents</span>
<span class="c1">#[&lt;title&gt;The Dormouse's story&lt;/title&gt;]
</span>
</code></pre></div></div>
<p>Above, please note: The <em>title</em> tag itself has a child: “The Dormouse’s story”, the <em>.descendants</em> attribute just is to use it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">head_tag</span><span class="o">.</span><span class="n">descendants</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">child</span>
<span class="c1">#&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
#&lt;title&gt;The Dormouse's story&lt;/title&gt;
#The Dormouse's story
</span></code></pre></div></div>

<p>If a tags only one child,and that child is a <em>NavigableString</em>(??), the child is available as <em>.string</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">title_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span>
<span class="k">print</span> <span class="n">title_tag</span><span class="o">.</span><span class="n">string</span>
<span class="c1"># The Dormouse's story
</span></code></pre></div></div>

<h5 id="string-and-stripped_string">.string and stripped_string</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">strings</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
<span class="c1"># print a lot
</span>
<span class="k">for</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">stripped_string</span><span class="p">:</span>
	<span class="k">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">string</span><span class="p">))</span>
<span class="c1"># discard "\n"
</span></code></pre></div></div>

<h3 id="going-up">Going up</h3>

<h4 id="parent">.parent</h4>
<p>You can access an elements parent with <em>.parnet</em>,for instance,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">title_tag</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">title</span>
<span class="k">print</span> <span class="n">title_tag</span>
<span class="c1">#&lt;title&gt;The Dormouse's story&lt;/title&gt;
</span>
<span class="k">print</span> <span class="n">title_tag</span><span class="o">.</span><span class="n">parent</span>
<span class="c1">#&lt;head&gt;&lt;title&gt;The Dormouse's story&lt;/title&gt;&lt;/head&gt;
</span>
</code></pre></div></div>

<h4 id="parents">.parents</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">link</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">a</span>

<span class="k">for</span> <span class="n">parent</span> <span class="ow">in</span> <span class="n">link</span><span class="o">.</span><span class="n">parents</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># p
# body
# html
# [document]
# None
</span></code></pre></div></div>

<p>This is a recursion usage to iterate over all elements’s parent.</p>

<h4 id="sideways">Sideways</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">soup_sibling</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">"&lt;a&gt;&lt;b&gt;text1&lt;/b&gt;&lt;c&gt;Test2&lt;/c&gt;&lt;/b&gt;&lt;/a&gt;"</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>

<span class="k">print</span> <span class="p">(</span><span class="n">soup_sibling</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="c1">#&lt;html&gt;
# &lt;body&gt;
#  &lt;a&gt;
#   &lt;b&gt;
#    text1
#   &lt;/b&gt;
#   &lt;c&gt;
#    Test2
#   &lt;/c&gt;
#  &lt;/a&gt;
# &lt;/body&gt;
#&lt;/html&gt;
</span>
</code></pre></div></div>
<p>The <b> tag and <c> tag are at the same level: they're both direct children of the same tag.We call them *siblings*.</c></b></p>

<h4 id="next_siblings-and-previous_sibling">.next_siblings and .previous_sibling</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">print</span> <span class="n">soup_sibling</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">next_sibling</span>
<span class="c1"># &lt;c&gt;Test2&lt;/c&gt;
</span>
<span class="k">print</span> <span class="n">soup_sibling</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">previous_sibling</span>
<span class="c1"># &lt;b&gt;text1&lt;/b&gt;
</span>
</code></pre></div></div>
<p>Certainly, there is a <em>next_sibling</em></p>

<p>Here, you should know <em>.next_elements</em>and <em>.previous_elements</em></p>

<h3 id="searching-the-tree">Searching the tree</h3>

<h4 id="a-string">A string</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'b'</span><span class="p">)</span>
<span class="c1">#[&lt;b&gt;The Dormouse's story&lt;/b&gt;]
# This is a list.
</span></code></pre></div></div>
<h4 id="a-regular-expression">A regular expression</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span>

<span class="c1">### @1
</span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"^b"</span><span class="p">)):</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1">##body
##b
</span>
<span class="c1">### @2
</span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"t"</span><span class="p">)):</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1">## html
## title
</span>
<span class="c1">### @3
</span><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">([</span><span class="s">"a"</span><span class="p">,</span> <span class="s">"b"</span><span class="p">])</span>

<span class="c1">### @4
</span><span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">print</span> <span class="p">(</span><span class="n">tag</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1">### @5
</span><span class="k">def</span> <span class="nf">has_class_but_no_id</span><span class="p">(</span><span class="n">tag</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tag</span><span class="o">.</span><span class="n">has_attr</span><span class="p">(</span><span class="s">'class'</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tag</span><span class="o">.</span><span class="n">has_attr</span><span class="p">(</span><span class="s">'id'</span><span class="p">)</span>

<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">has_class_but_no_id</span><span class="p">)</span>


<span class="c1">### @6
</span><span class="k">def</span> <span class="nf">not_lacie</span><span class="p">(</span><span class="n">href</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">href</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"lacie"</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">href</span><span class="p">)</span>

<span class="k">print</span> <span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="n">not_lacie</span><span class="p">))</span>
</code></pre></div></div>
<p>@1,here, this code finds all the <em>tags</em> whose names start with the letter “b”:in this case, the &lt;body&gt; tag and the <b> tag</b></p>

<p>@2: this code is to find tag whose name contains “t”.</p>

<p>@3: here is a list(arguments is and results is too)</p>

<p>@4: The argument is bool, it will list all tags in html_doc.</p>

<p>@5: You will pick up a tag &lt;p&gt; it contains “class”.This function only picks up the &lt;p&gt; tags. It doesn’t pick up the <a> tags, because those tags define both “class” and “id”. It doesn’t pick up tags like &lt;html&gt; and <title>, because those tags don’t define “class”.</title></a></p>

<p>@6: You will note the call for function.It will output two elements in a list,it both are <a></a> tag.</p>

<h4 id="find_all">find_all()</h4>
<p>The above usage is mentioned.her, <em>name</em> <em>keywords</em> argument, in a words:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">"title"</span><span class="p">)</span>

<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s">'link2'</span><span class="p">)</span>

<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">href</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">"elsie"</span><span class="p">))</span>
</code></pre></div></div>

<p>You can’t use a keyword argument to search for HTML’s ‘name’ element, because Beautiful Soup uses the name argument to contain the name of the tag itself. Instead, you can give a value to ‘name’ in the attrs argument.Below is code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="s">'&lt;input name="email"/&gt;'</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
<span class="c1">## @1
</span><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"email"</span><span class="p">)</span>

<span class="c1">## @2
</span><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s">"name"</span><span class="p">:</span><span class="s">"email"</span><span class="p">})</span>
<span class="c1">#[&lt;input name="email"/&gt;]
</span></code></pre></div></div>

<p>@1: it will print a empty list([]).</p>

<p>@2: it will print right result.</p>

<h2 id="css-class">CSS class</h2>
<p>The <em>class</em> is a keyword in python, so you have to use <em>class_</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">"a"</span><span class="p">,</span> <span class="n">class_</span> <span class="o">=</span> <span class="s">"sister"</span><span class="p">)</span>

</code></pre></div></div>

<p><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.html#going-up">here</a></p>

<h3 id="css-selector">CSS selector</h3>

<p>Beautiful Soup supports the most commonly-used CSS selectors. Just pass a string into the .select() method of a Tag object or the BeautifulSoup object itself.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">"title"</span><span class="p">)</span>
</code></pre></div></div>

<p>…</p>

<h2 id="output">Output</h2>
<p>The will turn BS into Unicode string.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span> <span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="c1">## it will print Unicode
</span>
<span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">)</span>
<span class="c1">## it will return UTF-8
</span></code></pre></div></div>

<h2 id="encodings">Encodings</h2>

<p>Use <em>.original_encoding</em> to displays documents’s encoding</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">original_encoding</span>
<span class="c1"># ascii
</span>
<span class="n">markup</span> <span class="o">=</span> <span class="n">b</span><span class="s">"&lt;h1&gt;</span><span class="se">\xed\xe5\xec\xf9</span><span class="s">&lt;/h1&gt;"</span>
<span class="c1"># 这个编码是iso-8859-8
# 如果你直接打印soup.original_encoding将会是 iso-8859-7
</span>
<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">markup</span> <span class="p">,</span> <span class="s">'lxml'</span><span class="p">,</span> <span class="n">from_encoding</span><span class="o">=</span><span class="s">"iso-8859-8"</span><span class="p">)</span>
<span class="c1"># 使用这个参数就会告诉BS正确的编码方式
</span>
<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">original_encoding</span>
<span class="c1">#这样就会打印iso-8859-8
</span>
</code></pre></div></div>
<p>这里才是我写这篇文章的目的，BS默认是把输入文档转化为Unicode,当然，输入时的文本编码是靠BS猜的，但是有可能猜错，所以这样你最好使用<em>from_encoding</em>参数指明输入的文本的编码格式。这里用汉语写出，以突出重点.</p>

<h2 id="输出编码output-encoding">输出编码(output encoding)</h2>

<p>BS输出时默认是UTF-8.请看下面的例子:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">html_doc</span> <span class="o">=</span> <span class="s">"""
&lt;html&gt;
    &lt;head&gt;
     &lt;meta content="text/html; charset=ISO-Latin-1"
     http-equiv="Content-type" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;p&gt;Sacr</span><span class="se">\xe9</span><span class="s"> bleu!&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;
"""</span>

<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_doc</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>

<span class="k">print</span> <span class="n">soup</span><span class="o">.</span><span class="n">original_encoding</span>
<span class="c1">#iso-latin-1
</span>
<span class="k">print</span> <span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">prettify</span><span class="p">())</span>
<span class="c1">#&lt;html&gt;
#	&lt;head&gt;
#		&lt;meta content="text/html;
#		charset=utf-8" http-equiv="Content-type"/&gt;
#	&lt;/head&gt;
#	&lt;body&gt;
#	&lt;p&gt;
#		  Sacré bleu!
#	&lt;/p&gt;
#	&lt;/body&gt;
#&lt;/html&gt;
</span></code></pre></div></div>
<p>请问能够看出什么东西来，对，就是这样的简单，BS可以根据&lt;html&gt;的字符集自动分析编码集，但是使用prettify()输出的时候就是”UTF-8”的编码。</p>

<p>赶快拿出笔记本记重点：如果prettify()的  <em>UTF-8</em>不是你的菜，你可以使用prettify()的编码方法。</p>

<h1 id="实例">实例</h1>

<p><a href="http://paper.people.com.cn/rmrb/html/2017-11/15/nw.D110000renmrb_20171115_1-09.htm">以这篇文章为例</a></p>

<p><img src="http://yuzibo.qiniudn.com/rmrb2.png" alt="rmrb2.png" /></p>

<p>为了提取图中的文字，可以使用下面的代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">import</span> <span class="nn">chardet</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
<span class="c1">#    target = 'http://paper.people.com.cn/rmrb/html/2017-11/15/nbs.D110000renmrb_09.htm'
</span>    <span class="n">target</span> <span class="o">=</span> <span class="s">'http://paper.people.com.cn/rmrb/html/2017-11/15/nw.D110000renmrb_20171115_1-09.htm'</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
    <span class="n">req</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf-8'</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">text</span>
    <span class="n">bf</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span> <span class="p">,</span><span class="s">'lxml'</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s">'postContent'</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">bf</span><span class="o">.</span><span class="n">h1</span><span class="o">.</span><span class="n">text</span>
    <span class="k">print</span> <span class="n">context</span><span class="o">.</span><span class="n">text</span>
</code></pre></div></div>

<p>参考：https://jiayi.space/post/yong-beautifulsoupti-qu-wang-ye-xin-xi-shi-li</p>

<h4 id="分行">分行</h4>
<p>这个东西从一开始就困扰我，现在还好些了，请看效果:</p>

<p><img src="http://yuzibo.qiniudn.com/rmrb3.png" alt="rmrb3.png" /></p>

<p>在这里，我们知道&lt;P&gt;&lt;/P&gt;标签就是分段的意思，同理，<br />也是同样的意思，你可以使用<em>.get_text</em>属性</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">bf</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">content</span> <span class="p">,</span><span class="s">'lxml'</span><span class="p">)</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s">'postContent'</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">context</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">separator</span> <span class="o">=</span> <span class="s">u'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
</code></pre></div></div>

<p>Please to see the picture:</p>

<p><img src="http://yuzibo.qiniudn.com/rmrb4.png" alt="rmrb4.png" /></p>


        </article>
        <hr>

        
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
        

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/2017/06/19/python_spider/">python之爬虫简介</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/2017/06/21/python_requests/">python之Requests的使用笔记</a></p>
        
    </div>
</div>


        <h2 id="comments">Comments</h2>
        





    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id])')
    for (var i = 0; i < aTags.length; i++) {
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             技术笔记！ 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/yuzibo" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:yuzibode@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script>
    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/prism.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <script type="text/javascript">
	$('pre').addClass("line-numbers");
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
