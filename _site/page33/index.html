<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>vimer</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://0.0.0.0:4000/page33/">
    <link rel="alternate" type="application/rss+xml" title="vimer" href="http://0.0.0.0:4000/feed.xml ">





</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">vimer</a>
        <small>linux kernel 爱好者</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Welcome to here</h1>
        <small>简单即生活</small>
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/11/11/DebianBuildKernel/">Debian编译linux内核</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-11-11
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#kernel" title="Category: kernel" rel="category">kernel</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <h1 id="终于成功一次了">终于成功一次了</h1>
<p>之前重新编译了好多次，可惜没有一次成功的，说实话，借助Debian强大的dpkg软件包管理，使得重新编译内核仅仅像安装软件一样简单，我都觉得这不是正宗的编译内核，好了，废话不多说，马上进入主题。</p>

<h2 id="下载内核源代码1">下载内核源代码(1)</h2>
<p>我没有使用最新的内核源代码，用的 3.2.64,我们可以在<a href="http://www.lkml.org">http://www.lkml.org</a>下载，注意这里我们下载的是.xz文件,需要解压两次。至于源代码放在哪里，完全取决于你自己，你想放在哪里就放在哪里，我直接放在在用户主目录都可以啊。</p>

<h2 id="解压">解压</h2>

<blockquote>
  <p>xz -d linux-xx</p>
</blockquote>

<p>(xx就是你下载的内核源代码的版本)，这时生成.tar文件，然后</p>

<blockquote>
  <p>tar -xvf linux-xx</p>
</blockquote>

<h2 id="安装所需的软件包">安装所需的软件包</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt-get install kernel-package libncurses5-dev fakeroot build-essential bc
</code></pre></div></div>

<h2 id="使用git">使用git</h2>

<p>利用git得到linus的最新 kernel,然后执行 <code class="highlighter-rouge">make clean</code>,接下来执行</p>

<p><code class="highlighter-rouge">make menuconfig</code></p>

<h3 id="tips">tips</h3>
<p>如果你想单独编译某个模块,可以单独地编译那个模块(不建立镜像)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make drivers/usb/serial
</code></pre></div></div>

<p>下面可以建立镜像</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make M=drivers/usb/serial
</code></pre></div></div>

<p>如果你想把内核镜像编译在别处,那么则可以使用</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make O=~/linux-kernel-image-dir
</code></pre></div></div>


                </div>
                <div class="read-all">
                    <a  href="/2014/11/11/DebianBuildKernel/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/11/06/LinuxModuleProgram1/">模块编程(1)Hello,World</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-11-06
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#kernel" title="Category: kernel" rel="category">kernel</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <h1 id="前戏">前戏</h1>
<p>看了这么多关于内核的东西，这两天终于上手实现了基于内核的编程——模块编程。
这里，简单的记录一下，因为还是有些东西需要牢记的。
先说点题外话，看到资料上说模块机制、设备机制、驱动机制是在linux上很重要的三种机制之一，所以，看起来，这真是万里长征的第一步。</p>

<h2 id="先建立一个源文件modulec">先建立一个源文件，module.c</h2>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include&lt;linux/init.h&gt;
#include&lt;linux/module.h&gt;
#include&lt;linux/kernel.h&gt;
</span><span class="c1">//上面的三个头文件必须有</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">"GPL"</span><span class="p">);</span><span class="c1">//模块许可声明</span>
<span class="cm">/*下面的__init 是一个宏，在include/linux/init.h里面*/</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">hello_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printk</span><span class="p">(</span><span class="s">"Hello,world</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">hello_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printk</span><span class="p">(</span><span class="s">"GoodBye</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="cm">/*初始化*/</span>
<span class="n">module_init</span><span class="p">(</span><span class="n">hello_init</span><span class="p">);</span>
<span class="cm">/*退出时使用*/</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">hello_exit</span><span class="p">);</span></code></pre></figure>

<p>简单解释一下，一个模块源程序的</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.头文件(必有)
2.模块参数(可选)
3.模块功能函数(optional)
4.模块加载函数(必有)
5.模块卸载函数(必有)
6.模块许可声明(必有)。
</code></pre></div></div>

<h2 id="在相同目录下创建一个-makefile文件">在相同目录下创建一个 Makefile文件</h2>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">ifeq <span class="o">(</span><span class="k">$(</span>KERNELRELEASE<span class="k">)</span>,<span class="o">)</span>
	VERSION_NUM :<span class="o">=</span><span class="k">$(</span>shell <span class="nb">uname</span> <span class="nt">-r</span><span class="k">)</span>
    CURRENT_PATH :<span class="o">=</span><span class="k">$(</span>shell <span class="nb">pwd</span><span class="k">)</span>
	KERNEL_DIR :<span class="o">=</span>/usr/src/linux-headers-<span class="k">$(</span>VERSION_NUM<span class="k">)</span>

modules:
	<span class="k">$(</span>MAKE<span class="k">)</span> <span class="nt">-C</span> <span class="k">$(</span>KERNEL_DIR<span class="k">)</span> <span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span> modules
modules_installs:
	<span class="k">$(</span>MAKE<span class="k">)</span> <span class="nt">-C</span> <span class="k">$(</span>KERNEL_DIR<span class="k">)</span> <span class="nv">M</span><span class="o">=</span><span class="k">$(</span>PWD<span class="k">)</span> modules_installs
clean:
	<span class="nb">rm</span> <span class="nt">-rf</span> <span class="k">*</span>.o <span class="k">*</span>~ core .depend .<span class="k">*</span>.cmd <span class="k">*</span>.ko <span class="k">*</span>.mod.c .tmp_versions <span class="k">*</span>.order <span class="k">*</span>.symvers
<span class="k">else
	</span>obj-m :<span class="o">=</span> module.o
endif</code></pre></figure>

<p>关于Makefile文件的知识不是这篇文章的内容，但我们会努力讲解的简单明了一些。其中使用了shell中的选择判断语句，先取得当前系统的版本号，模块源文件所在的目录、内核文件的目录、然后就是目标依赖关系，当然这部分我自己也是不很明白，还需要彻底了解一下相关知识。看上去先产生模块，然后安装modules,这些都是make命令执行后运行的东西。如果我们执行 make clean 紧接着就是清除所在目录产生的中间文件文件，当然，你可以添加自己的规则。</p>

<h3 id="2017-02-08-add">2017-02-08 add</h3>

<p>上面的 Makefile是针对于你的发行版的，找到你的镜像(kernel)头文件包，下面是 linux kernel tree编译内核模块的方法</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">obj</span><span class="o">-</span><span class="n">m</span> <span class="o">+=</span> <span class="n">module</span><span class="p">.</span><span class="n">o</span>

<span class="n">all</span><span class="o">:</span>
	<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="err">$</span><span class="p">(</span><span class="n">shell</span> <span class="n">uname</span> <span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">build</span> <span class="n">M</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">PWD</span><span class="p">)</span> <span class="n">modules</span>

<span class="n">clean</span><span class="o">:</span>
	<span class="n">make</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="err">$</span><span class="p">(</span><span class="n">shell</span> <span class="n">uname</span> <span class="o">-</span><span class="n">r</span><span class="p">)</span><span class="o">/</span><span class="n">build</span> <span class="n">M</span><span class="o">=</span><span class="err">$</span><span class="p">(</span><span class="n">PWD</span><span class="p">)</span> <span class="n">clean</span>
</code></pre></div></div>

<p>使用这个  Makefile 就可以在自己编译的内核中编译自己的模块，记住一点，你正在运行的内核与 linux kernel tree必须一致，不然会有错误报出。</p>

<p>好，我们将所有的准备工作做好后，执行一下,(sudo 模式)</p>

<p><strong>make</strong></p>

<p>我们会看到如下信息：</p>

<p><img src="http://yuzibo.qiniudn.com/2014-11-06-makeafter.png" alt="图片" /></p>

<p>紧接着执行</p>

<p><strong>insmod module.ko</strong></p>

<p>,我们打开另一个终端，执行命令</p>

<p><strong>tail -f /var/log/message</strong></p>

<p>我们回到原来的窗口再执行</p>

<p><strong>rmmod module.ko</strong></p>

<p>这两条命令执行后在另一个窗口我们会看到如下信息：</p>

<p><img src="http://yuzibo.qiniudn.com/2014-11-06-modulesofresult.png" alt="图片" /></p>

<p>回到原来的窗口，我们执行 <strong>make clean</strong>,就只剩下了原来的文件。</p>

<h1 id="模块的操作">模块的操作</h1>

<p>Linux为用户提供了modutils工具，用来操作模块，包括以下命令</p>

<h2 id="insmod">insmod</h2>

<table>
  <tbody>
    <tr>
      <td>这个命令是加载模块，使用 <strong>insmod module.ko</strong>可以加载module.ko模块，执行该命令后如果终端没有消息，则可以使用命令 demsg</td>
      <td>tail 命令查看文件的最后几行.</td>
    </tr>
  </tbody>
</table>

<h2 id="rmmod">rmmod</h2>

<p>rmmod module.ko就是将module.ko模块卸载。</p>

<h2 id="modprobe">modprobe</h2>

<p>比较高级的加载和卸载模块的命令，可以解决模块之间的依赖性。</p>

<h2 id="modinfo">modinfo</h2>
<p>用于查询模块的相关信息，如作者、版权等。</p>

<h1 id="模块加载后文件系统的变化">模块加载后文件系统的变化</h1>

<h2 id="在procmodules中会增加相关的模块信息如下">在/proc/modules中会增加相关的模块信息,如下，</h2>

<p><img src="http://yuzibo.qiniudn.com/2014-11-06-proc-module.png" alt="图片" /></p>

<h2 id="procdevices没有变化">/proc/devices没有变化</h2>
<h2 id="在sysmodules会增加一个module目录我们用-tree--a-module会发现如下信息">在/sys/modules会增加一个module目录，我们用 <strong>tree -a module</strong>,会发现如下信息：</h2>

<p><img src="http://yuzibo.qiniudn.com/2014-11-06-treeforsysmodule.png" alt="图片" /></p>

                </div>
                <div class="read-all">
                    <a  href="/2014/11/06/LinuxModuleProgram1/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/11/04/DebianInstallBochs/">Debian安装Bochs</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-11-04
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#tools" title="Category: tools" rel="category">tools</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <p>#问题阐述
最近安装了很多的软件，总是为了折腾linux而为的，今天晚上不小心把Bochs安装完毕，在此发文纪念一下了。</p>

<p>由于安装这个这个bochs中间因为网站的问题而搁置了好几天，但在linux系统下安装bochs总不能少了那几个软件包的支持，具体是哪几个我忘了。
#步骤</p>

<p>1.首先到bochs.sourceforge.net下载bochs源代码包并解压缩。</p>

<p>2.然后要安装五个软件，否则make，make install时会失败。</p>

<p><strong>apt-get nstall build-essential xorg-dev bison libgtk2.0-dev libtool libx11-dev xserver-xorg-dev</strong></p>

<p>3.进入所在目录，开始配置</p>

<p><strong>./configure –enable-debugger –enable-disasm</strong></p>

<p>两个enable分别表示启用bochs调试和反汇编。</p>

<p>4.<strong>make</strong></p>

<p>5.<strong>make install</strong></p>

<p>这只是把软件安装上了，最重要的一步还没做：配置bochs的文件。
由于我把bochs文件解压到用户目录下，所以该配置文件.bochsrc就可以放在用户目录下</p>

<p>##tips
网上有教程说配置liunx0.11内核，关键是我不知道这有什么作用，下面是linux0.11网址
<a href="http://www.oldlinux.org/Linux.old/images/bootimage-0.11-20040305">linux 0.11</a></p>

<p>6.配置bochs启动文件</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#how much memory the emulated will have</span>
megs: 32
<span class="c">#filename of ROM images</span>
romimage: <span class="nv">file</span><span class="o">=</span>/home/yubo/bochs/bios/BIOS-bochs-latest

vgaromimage: <span class="nv">file</span><span class="o">=</span>/home/yubo/bochs/bios/VGABIOS-lgpl-latest

<span class="c">#vga: extension=vbe</span>
<span class="c">#what disk image will be used</span>
floppya: <span class="nv">1_44</span><span class="o">=</span>/home/yubo/a.img,status<span class="o">=</span>inserted  <span class="c">#注意路径一定要写全,我这里把镜像文件放在了用户目录下的中，下同</span>

<span class="c">#floppyb: 1_44=/home/yubo/bochs/linux0.11/rootimage-0.11-20040305,status=inserted  #注意路径一定要写全</span>
<span class="c">#choose the boot disk</span>
boot: floppy

log: bochsout.txt
<span class="c">#disable mouse</span>
mouse: <span class="nv">enabled</span><span class="o">=</span>0

</code></pre></div></div>

<p>看到没，我们对Bochs的控制全在这里，包括映像文件的路径和启动顺序，至于a.img是在怎么来的，请看下面的东东，我们将配置文件写好以后，使用命令</p>

<p><strong>bochs</strong></p>

<p>会出来选项，直接回车(就是选择6),然后弹出一个窗口，在原来窗口的提示内键入</p>

<p><strong>c</strong></p>

<p>这时你再看模拟器窗口，啊，整个世界开朗了。
#Bochs的使用
其实在上面的安装过程中，我可能遗漏了很多组建，默认安装Bochs及其组件可以使用以下命令：</p>

<p>sudo apt-get install vgabios bochs bochs-x bximage</p>

<p>当然，首先推荐使用源码安装这样可以设置一些自己想要的功能，比如调试。</p>

<p>“计算机”安装好了，我们接下来应该怎么办呢？对了，安装硬盘或者软盘，你总得让计算机启动吧，就是使用__bximage__命令。</p>

<p>bximage：</p>

<p>出现以下界面，</p>
<pre>
yubo@debian:~$ bximage
========================================================================
                                bximage
  Disk Image Creation / Conversion / Resize and Commit Tool for Bochs
         $Id: bximage.cc 12364 2014-06-07 07:32:06Z vruppert $
========================================================================

1. Create new floppy or hard disk image
2. Convert hard disk image to other format (mode)
3. Resize hard disk image
4. Commit 'undoable' redolog to base image
5. Disk image info

0. Quit

Please choose one [0] 1
Create image

Do you want to create a floppy disk image or a hard disk image?
Please type hd or fd. [hd] fd

Choose the size of floppy disk image to create, in megabytes.
Please type 160k, 180k, 320k, 360k, 720k, 1.2M, 1.44M, 1.68M, 1.72M, or 2.88M.
 [1.44M]

What should be the name of the image?
[a.img]

Creating floppy image 'a.img' with 2880 sectors

The following line should appear in your bochsrc:
  floppya: image="a.img", status=inserted
</pre>
<p>这时在当前目录下产生了一个 a.img,这就是我们需要的软盘映像(自己想把img文件的格式学习一下，结果网上的资料不是很多)，书上说映像文件是按字节复制，记住，a
.img只是一个软盘，没有任何东西，我们接下来要把编译的二进制文件(引导扇区)写进软盘里</p>
<pre>
yubo@debian:~$ dd if=boot.bin of=a.img bs=512 count=1 conv=notrunc
记录了1+0 的读入
记录了1+0 的写出
512字节(512 B)已复制，9.3823e-05 秒，5.5 MB/秒
</pre>
<p>稍微解释一下这个命令，if是input file的缩写，of是out file的缩写，也就是目标文件，bs是文件的大小，count不是很清楚，conv=notrune是不要截断.
注意路径问题就行</p>

<h2 id="下面是bootasm文件我们使用命令">下面是boot.asm文件，我们使用命令</h2>

<p><strong>nasm boot.asm -o boot.bin</strong></p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">org</span> <span class="mo">07</span><span class="n">c00h</span> <span class="p">;</span><span class="n">load</span> <span class="n">first</span> <span class="n">instructor</span> <span class="n">notify</span> <span class="n">compile</span>

<span class="n">mov</span> <span class="n">ax</span><span class="p">,</span><span class="n">cs</span>
<span class="n">mov</span> <span class="n">ds</span><span class="p">,</span><span class="n">ax</span>
<span class="n">mov</span> <span class="n">es</span><span class="p">,</span><span class="n">ax</span>

<span class="n">call</span> <span class="n">DispStr</span> <span class="p">;</span><span class="n">call</span> <span class="kt">char</span> <span class="n">functions</span>

<span class="n">jmp</span> <span class="err">$</span><span class="p">;</span> <span class="n">loop</span>

<span class="n">DispStr</span><span class="o">:</span>
	<span class="n">mov</span> <span class="n">ax</span><span class="p">,</span><span class="n">BootMessage</span>
	<span class="n">mov</span> <span class="n">bp</span><span class="p">,</span><span class="n">ax</span>
	<span class="n">mov</span> <span class="n">cx</span><span class="p">,</span><span class="mi">16</span>
	<span class="n">mov</span> <span class="n">ax</span><span class="p">,</span><span class="mo">01301</span><span class="n">h</span>
	<span class="n">mov</span> <span class="n">bx</span><span class="p">,</span><span class="mo">000</span><span class="n">ch</span>
	<span class="n">mov</span> <span class="n">dl</span><span class="p">,</span><span class="mi">0</span>
	<span class="kt">int</span> <span class="mi">10</span><span class="n">h</span>
	<span class="n">ret</span>
	<span class="n">BootMessage</span><span class="o">:</span> <span class="n">db</span> <span class="s">"hello,OS world!"</span>
	<span class="n">times</span> <span class="mi">510</span><span class="o">-</span><span class="p">(</span><span class="err">$</span><span class="o">-</span><span class="err">$$</span><span class="p">)</span> <span class="n">db</span> <span class="mi">0</span>
	<span class="n">dw</span> <span class="mh">0xaa55</span>
</code></pre></div></div>

<p>简单介绍下这个文件的意思，引导扇区，是从0面0磁道1扇区到0xAA55,之间应包含少于512字节的执行码，一旦BIOS发现了引导扇区，就会将这512字节的内容装载到内存地址0000:7c00处，然后跳转到0000:7c00处将控制权交给这段引导代码。</p>

                </div>
                <div class="read-all">
                    <a  href="/2014/11/04/DebianInstallBochs/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/11/02/AllKindOfPeriod/">周期概念辨析</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-11-02
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#OS" title="Category: OS" rel="category">OS</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <h1 id="时钟周期振荡周期机器周期cpu周期状态周期指令周期总线周期任务周期">时钟周期、振荡周期、机器周期、CPU周期、状态周期、指令周期、总线周期、任务周期</h1>

<p>近来在专业课的学习中，时不时碰到周期的字眼，借用这个时间将这几个概念整理一下。</p>

<h2 id="机器周期">机器周期</h2>
<p>在计算机中为了便于管理，常把一条指令的执行过程划分为若干个阶段，每个阶段完成一项工作。比如，与微机系统有关指令命令，如取指令，读、写存储器等，每一项操作称为一个基本操作，完成一个基本操作所需要的时间称为机器周期，通常一个机器周期由若干S周期(状态周期)组成。</p>

<h2 id="cpu周期">CPU周期</h2>
<p>通常用内存中读取一个指令字的最短时间来规定CPU周期。</p>

<h2 id="指令周期instruction-cycle">指令周期（Instruction Cycle）</h2>
<p>取出并执行一条指令的时间，一个指令周期由若干CPU周期构成。</p>

<h2 id="时钟周期clock-cycle">时钟周期（Clock Cycle）</h2>
<p>又称为振荡周期，是处理操作的最基本的单位。</p>

<h2 id="节拍与状态">节拍与状态</h2>
<p>把振荡脉冲的周期定义为节拍（用p表示），振荡周期经过二分频后定义为状态，一个状态就包含两个节拍。</p>

<h2 id="状态周期">状态周期</h2>
<p>两个振荡周期（时钟周期）组成一个状态周期。</p>

<h2 id="总线周期bus-cycle">总线周期（Bus Cycle）</h2>
<p>也就是一次通过总线访问存储器或I/O端口的时间，一般一个总线周期包括4个时钟周期，这4个时钟周期又分别称为T1状态、T2状态、T3状态、T4状态</p>

                </div>
                <div class="read-all">
                    <a  href="/2014/11/02/AllKindOfPeriod/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/10/30/VirtualBoxConnection/">Virtualboxconnection</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-10-30
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    



                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <hr />
<p>layout: post
category: network
title: “虚拟机与主机的连接方式”
—</p>
<h1 id="问题">问题</h1>
<p>主机与虚拟机的连接方式有 bridged(桥连)，NAT(网络地址转换模式)和host-only(主机模式)，不同的连接方式对应不同的网卡。</p>

<h1 id="补充">补充</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>在Linux下面ifconfig显示的eth0是第一个网卡ip(eth就是ethenet以太网，这里指网络接口)

1. 桥连方式(bridged)

在桥连方式下你可以把虚拟出来的操作系统看成一部独立的主机，你需要手工为虚拟系统配合ip地址、子网掩码、而且还要和宿主机器处于同一网段，这样虚拟机才能和宿主机器进行通行。从名字上讲，我们可以把宿主系统看作一座桥，连接的就是虚拟机器，利用这种方式连接的机器，就像连接在同一 hub的两台机器。如果你想利用虚拟机的机器提供网络服务，就应该选择 bridged方式。这种方式最简单，直接将虚拟网卡接到一个物理网卡上，和linux下一个网卡绑定两个不同的地址类似，实际上是将网卡设置为混杂模式，从而达到侦听多个ip的能力。

2. 网络地址转换(NAT)

说的简单一点，这种方式就是利用虚拟机给虚拟系统(DHCP服务器)给虚拟系统分配一个可上网的ip，简单明了，还可以实现 Host Os和Guest Os的双向访问(这句话明显有错误)，但与Host Os同一网段的其他机器无法像桥连方式那样轻松访问Guest Os。

你可以简单的认为虚拟机中的数据都是由宿主系统提供的，虚拟机可以通过网络访问主机，主机无法通过网络访问虚拟机。

ip:10.0.2.15

网关: 10.0.2.2

DNS: 10.0.2.3
</code></pre></div></div>


                </div>
                <div class="read-all">
                    <a  href="/2014/10/30/VirtualBoxConnection/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2014/10/30/LinuxCloseIptables/">linux关闭防火墙</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2014-10-30
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#shell" title="Category: shell" rel="category">shell</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <h1 id="问题">问题</h1>
<p>最近在折腾虚拟机，因为两个机器之间的访问而忙的焦头烂额，在弄明白主机与虚拟机之间的联系方式后，有些问题还是让我心存疑惑。其中之一，我就纳闷是不是因为我的虚拟机的防火墙没有关闭，导致主机ping不动主机，于是乎，随手google了一下，将这个问题记录一下。奥，忘了，我的宿主系统及虚拟系统是Debian.所有操作是在root权限执行的。</p>

<h2 id="首先确认你的系统已经安装iptables">首先确认你的系统已经安装Iptables</h2>

<p><strong>whereis iptables</strong></p>

<h2 id="查看iptables目前的配置信息">查看Iptables目前的配置信息</h2>

<p><strong>sudo iptables -L</strong></p>

<p>如果你第一次安装配置 iptables，会得到如下信息，
`
Chain INPUT (policy ACCEPT)
target prot opt source destination
Chain FORWARD (policy ACCEPT)
target prot opt source destination
Chain OUTPUT (policy ACCEPT)
target prot opt source destination
`</p>


                </div>
                <div class="read-all">
                    <a  href="/2014/10/30/LinuxCloseIptables/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <a href="/index.html" class="previous"><i class="fa fa-angle-double-left"></i></a>
            <a href="/page32" class="previous"><i class="fa fa-angle-left"></i></a>
          
          <span class="page_number ">33/36</span>
          
            <a href="/page34" class="next"><i class="fa fa-angle-right"></i></a>
            <a href="/page36" class="next"><i class="fa fa-angle-double-right"></i></a>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    Recent Posts
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2018/09/20/blog-update-themes/">blog更换主题</a></li>
                    
                        <li><a href="/2018/09/16/debian-desktop/">debian桌面系统</a></li>
                    
                        <li><a href="/2018/08/31/sdn_summary/">SDN之OVS学习</a></li>
                    
                        <li><a href="/2018/06/12/git-push/">git pull-request使用简介</a></li>
                    
                        <li><a href="/2018/06/04/libvirt-trouble-summary/">libvirt问题汇总</a></li>
                    
                        <li><a href="/2018/06/03/ebpf-kernel/">ebpf基础知识</a></li>
                    
                        <li><a href="/2018/06/02/neomutt-imap-126/">Neomutt使用126邮箱的imap</a></li>
                    
                        <li><a href="/2018/05/22/leetcode-easy/">leetcode easy task</a></li>
                    
                        <li><a href="/2018/05/21/xdp-introducation/">xdp简介</a></li>
                    
                        <li><a href="/2018/05/13/bpf-bcc/">BPF-bcc usage</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    Categories
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#experience" class="categories-list-item" cate="experience">
                            <span class="name">
                                experience
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#debian" class="categories-list-item" cate="debian">
                            <span class="name">
                                debian
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#tools" class="categories-list-item" cate="tools">
                            <span class="name">
                                tools
                            </span>
                            <span class="badge">28</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#plan" class="categories-list-item" cate="plan">
                            <span class="name">
                                plan
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#algorithm" class="categories-list-item" cate="algorithm">
                            <span class="name">
                                algorithm
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#DS" class="categories-list-item" cate="DS">
                            <span class="name">
                                DS
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#mood" class="categories-list-item" cate="mood">
                            <span class="name">
                                mood
                            </span>
                            <span class="badge">7</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#OS" class="categories-list-item" cate="OS">
                            <span class="name">
                                OS
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#shell" class="categories-list-item" cate="shell">
                            <span class="name">
                                shell
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#kernel" class="categories-list-item" cate="kernel">
                            <span class="name">
                                kernel
                            </span>
                            <span class="badge">26</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#book" class="categories-list-item" cate="book">
                            <span class="name">
                                book
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#git" class="categories-list-item" cate="git">
                            <span class="name">
                                git
                            </span>
                            <span class="badge">12</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#c" class="categories-list-item" cate="c">
                            <span class="name">
                                c
                            </span>
                            <span class="badge">13</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#perl" class="categories-list-item" cate="perl">
                            <span class="name">
                                perl
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#assembly" class="categories-list-item" cate="assembly">
                            <span class="name">
                                assembly
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#make" class="categories-list-item" cate="make">
                            <span class="name">
                                make
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#python" class="categories-list-item" cate="python">
                            <span class="name">
                                python
                            </span>
                            <span class="badge">18</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#java" class="categories-list-item" cate="java">
                            <span class="name">
                                java
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#mysql" class="categories-list-item" cate="mysql">
                            <span class="name">
                                mysql
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#network" class="categories-list-item" cate="network">
                            <span class="name">
                                network
                            </span>
                            <span class="badge">8</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#unix" class="categories-list-item" cate="unix">
                            <span class="name">
                                unix
                            </span>
                            <span class="badge">10</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#css" class="categories-list-item" cate="css">
                            <span class="name">
                                css
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#dhc" class="categories-list-item" cate="dhc">
                            <span class="name">
                                dhc
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#javascript" class="categories-list-item" cate="javascript">
                            <span class="name">
                                javascript
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#oracle" class="categories-list-item" cate="oracle">
                            <span class="name">
                                oracle
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#system" class="categories-list-item" cate="system">
                            <span class="name">
                                system
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#english" class="categories-list-item" cate="english">
                            <span class="name">
                                english
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#writing" class="categories-list-item" cate="writing">
                            <span class="name">
                                writing
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#math" class="categories-list-item" cate="math">
                            <span class="name">
                                math
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#word" class="categories-list-item" cate="word">
                            <span class="name">
                                word
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#leetcode" class="categories-list-item" cate="leetcode">
                            <span class="name">
                                leetcode
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#H4X0r" class="categories-list-item" cate="H4X0r">
                            <span class="name">
                                H4X0r
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#django" class="categories-list-item" cate="django">
                            <span class="name">
                                django
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#life" class="categories-list-item" cate="life">
                            <span class="name">
                                life
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#nft" class="categories-list-item" cate="nft">
                            <span class="name">
                                nft
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#kvms" class="categories-list-item" cate="kvms">
                            <span class="name">
                                kvms
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#patent" class="categories-list-item" cate="patent">
                            <span class="name">
                                patent
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#bpf" class="categories-list-item" cate="bpf">
                            <span class="name">
                                bpf
                            </span>
                            <span class="badge">3</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#xdp" class="categories-list-item" cate="xdp">
                            <span class="name">
                                xdp
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#sdn" class="categories-list-item" cate="sdn">
                            <span class="name">
                                sdn
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    Tags
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                      
                      
                      
                      
                      
                      <a href="/tag/#experience" style="font-size: 18pt; color: #000;">experience</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#CS" style="font-size: 9pt; color: #999;">CS</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#English" style="font-size: 9pt; color: #999;">English</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#linux" style="font-size: 9pt; color: #999;">linux</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#mood" style="font-size: 9pt; color: #999;">mood</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#She" style="font-size: 9pt; color: #999;">She</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#FreeDos" style="font-size: 9pt; color: #999;">FreeDos</a>
                    
                </div>
            </div>

            <!-- <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul  class="content-ul">

                </ul>
            </div> -->
        </div>
    </div>
</div>
<!-- <script src="/js/scroll.min.js " charset="utf-8"></script> -->
<!-- <script src="/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             技术笔记！ 
        </p>
        <p class="contact">
            Contact me at: 
            <a href="https://github.com/yuzibo" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:yuzibode@126.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        
        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/Gaohaoyang">HyG</a>.
            </span>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script type="text/javascript" charset="utf-8" src="https://changyan.itc.cn/js/lib/jquery.js"></script>
    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/prism.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
    <script type="text/javascript">
	$('pre').addClass("line-numbers");
    </script>
    <!-- <script src=" /js/scroll.min.js " charset="utf-8"></script> -->
  </body>

</html>
